<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Account Creation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">

    <style>
        body {
            /* height: 97vh; */
            background-color: #f1f3f4;
            justify-content: center;
            display: flex;
            font-family: 'Google Sans', Arial, sans-serif;
        }

        .container {
            background-color: #fff;
            padding: 20px;
            width: 1000px;
            /* height: 850px;  */
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }


        .form-control {
            transition: border-color 0.3s ease;
        }

        .form-control:hover,
        .form-control:focus {
            border-color: #007bff;
            box-shadow: 0 0 0px rgba(0, 123, 255, 0.5);
        }

        .error {
            color: red;
            font-size: 14px;
            display: none;
        }


        .card-content {
            display: none;
        }

        .active {
            display: block;
        }
    </style>
</head>

<body>
    <div class="container mt-4 mb-4">
        <div class="card-content active">
            <div class="row">
                <div class="col">
                    <div class="d-flex justify-content-center align-items-center mt-3">
                        <img src="https://cdn2.iconfinder.com/data/icons/social-icons-33/128/Google-128.png" width="45"
                            height="45" class="me-2">
                        <h1 class="fs-2 fw-normal mt-3 ps-3">Create a Google account</h1>
                    </div>
                </div>
                <div class="row mt-5">
                    <div class="col">
                        <div>
                            <input type="text" id="first-name" class="form-control py-2" name="first-name"
                                placeholder="First name" />
                            <div class="error" id="first-name-error">Enter first name</div>
                        </div>
                    </div>
                    <div class="col">
                        <div>
                            <input type="text" id="last-name" class="form-control py-2 " name="last-name"
                                placeholder="Last name(optional)" />
                            <div class="error" id="last-name-error">Are you sure that you've entered your name
                                correctly?</div>
                        </div>
                    </div>
                </div>

                <div class="row mt-5">
                    <div class="col">
                        <input type="text" id="dob-date" class="form-control py-2" name="date" placeholder="Date" />
                    </div>
                    <div class="col">
                        <select id="dob-month" class="form-control py-2">
                            <option value="">Month</option>
                            <option value="1">January</option>
                            <option value="2">February</option>
                            <option value="3">March</option>
                            <option value="4">April</option>
                            <option value="5">May</option>
                            <option value="6">June</option>
                            <option value="7">July</option>
                            <option value="8">August</option>
                            <option value="9">September</option>
                            <option value="10">October</option>
                            <option value="11">November</option>
                            <option value="12">December</option>
                        </select>
                    </div>
                    <div class="col">
                        <input type="text" id="dob-year" class="form-control py-2" name="year" placeholder="Year">
                    </div>
                    <div class="error" id="dob-error">Enter a valid date of birth</div>
                </div>
                <div class="row mt-5">
                    <div class="col">
                        <select id="gender" class="form-control py-2">
                            <option value="">Select Gender</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                            <option value="Other">Rather not say</option>
                            <option value="Other">customised</option>
                        </select>
                    </div>
                    <div class="error" id="gender-error">Select a gender</div>
                </div>
                <div class="row mt-5">
                    <div class="col">
                        <input type="text" id="user-name" class="form-control py-2" name="email"
                            placeholder="Username" />
                        <div class="error" id="user-name-error">Enter a valid email address</div>
                    </div>
                </div>
                <div class="row mt-5">
                    <div class="col">
                        <input type="password" id="password" class="form-control py-2" name="password"
                            placeholder="Password" />
                        <div class="error" id="password-error">Password must be at least 8 characters long and include
                            uppercase, lowercase, number, and special character</div>
                    </div>
                    <div class="col">
                        <input type="password" id="confirm" class="form-control py-2 " name="confirm"
                            placeholder="Confirm" />
                        <div class="error" id="confirm-error">Passwords do not match</div>
                    </div>
                    <div class="mt-3  d-flex justify-content-end">
                        <input type="checkbox" id="show-password"> Show Password
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col d-flex justify-content-start ">
                        <button type="button" class="btn btn-primary mt-5 rounded-pill" id="viewtablebtn"
                            name="next">View table
                        </button>
                    </div>
                    <div class="col d-flex justify-content-end ">
                        <button type="submit" id="nextBtn" class="btn btn-primary mt-5 rounded-pill nextBtn"
                            name="next">Submit
                        </button>
                        <button type="button" id="update-btn" class="btn btn-primary mt-5 rounded-pill"
                            style="display: none;">Update</button>

                    </div>
                </div>
            </div>
        </div>

        <div class="card-content mt-4 mb-4">
            <div class="col">
                <div class="row table-responsive">
                    <h2 class="text-center">User Details</h2>
                    <table id="userTable" class="table table-bordered table-striped ">
                        <thead class="table-dark">
                            <tr>
                                <th>S.no</th>
                                <th>First-name</th>
                                <th>Last-name</th>
                                <th>D.O.B</th>
                                <th>Gender</th>
                                <th>User-name</th>
                                <th>Password</th>
                                <th>Create-date</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
                <div class="row d-flex justify-content-end">
                    <div class="col-auto">
                        <button type="button" id="back" class="btn btn-primary mt-5 rounded-pill">back</button>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>

    <script>
        function restrictInput(event, maxLength) {
            let input = $(event.target);
            let value = input.value.replace(/\D/g, "");
            input.val(value.substring(0, maxLength));
        }

        $("dob-date").on("input", function (event) {
            restrictInput(event, 2);
        });

        $("dob-year").on("input", function (event) {
            restrictInput(event, 4);
        });

        $("#show-password").on("change", function () {
            let isChecked = $(this).is(":checked");
            $("#password, #confirm").attr("type", isChecked ? "text" : "password");
        });

        function updateTable() {
            let users = JSON.parse(localStorage.getItem("users")) || [];

            if ($.fn.DataTable.isDataTable("#userTable")) {
                let table = $("#userTable").DataTable();
                table.clear(); 

                users.forEach((user, index) => {
                    table.row.add([
                        index + 1,
                        user.firstName,
                        user.lastName,
                        user.dob,
                        user.gender,
                        user.userEmail,
                        user.password,
                        user.createDate || "N/A",
                        `<i class="fa-solid fa-pen-to-square text-primary me-2 edit-user" data-id="${user.id}"></i>
                 <i class="fa-solid fa-trash text-danger delete-user" data-id="${user.id}"></i>`
                    ]);
                });

                table.draw(); 
            } else {
                $("#userTable").DataTable({
                    data: users.map((user, index) => [
                        index + 1,
                        user.firstName,
                        user.lastName,
                        user.dob,
                        user.gender,
                        user.userEmail,
                        user.password,
                        user.createDate || "N/A",
                        `<i class="fa-solid fa-pen-to-square text-primary me-2 edit-user" data-id="${user.id}"></i>
                 <i class="fa-solid fa-trash text-danger delete-user" data-id="${user.id}"></i>`
                    ]),
                    
                    paging: true,
                    searching: true,
                    ordering: true,
                    responsive: true
                });
            }
        }



        $("#viewtablebtn").on("click", function () {
            showCard(1);
            updateTable();

        });

        $("#back").on("click", function () {
            $("#first-name").val("");
            $("#last-name").val("");
            $("#dob-date").val("");
            $("#dob-month").val("");
            $("#dob-year").val("");
            $("#gender").val("");
            $("#user-name").val("");
            $("#password").val("");
            $("#confirm").val("");


            $("#update-btn").hide();
            $("#nextBtn").show();
            $(".error").hide();
            showCard(0);
        });


        $(document).on("click", ".delete-user", function () {
            let userId = $(this).data("id");
            let users = JSON.parse(localStorage.getItem("users")) || [];
            users = users.filter(user => user.id !== userId);
            localStorage.setItem("users", JSON.stringify(users));
            alert("Are you sure you want to delete this user?");
            updateTable();
        });

        $(document).on("click", ".edit-user", function () {
            let userId = $(this).data("id");
            let users = JSON.parse(localStorage.getItem("users")) || [];
            let user = users.find(user => user.id === userId);

            localStorage.setItem("editUser", JSON.stringify(user));
            localStorage.setItem("editingUserId", user.id);

            $("#first-name").val(user.firstName || "");
            $("#last-name").val(user.lastName || "");

            let dobParts = user.dob ? user.dob.split("-") : ["", "", ""];
            $("#dob-date").val(dobParts[0] || "");
            $("#dob-month").val(dobParts[1] || "");
            $("#dob-year").val(dobParts[2] || "");

            $("#gender").val(user.gender || "");
            $("#user-name").val(user.userEmail || "");
            $("#password, #confirm").val(user.password || "");

            $("#nextBtn").hide();
            $("#update-btn").show();

            showCard(0);
        });

        $("#update-btn").on("click", function () {
            let userId = localStorage.getItem("editingUserId");
            let users = JSON.parse(localStorage.getItem("users")) || [];

            let updatedUser = {
                id: parseInt(userId),
                firstName: $("#first-name").val().trim(),
                lastName: $("#last-name").val().trim(),
                dob: `${$("#dob-date").val().trim()}-${$("#dob-month").val()}-${$("#dob-year").val().trim()}`,
                gender: $("#gender").val(),
                userEmail: $("#user-name").val().trim(),
                password: $("#password").val().trim(),
                createDate: new Date().toLocaleDateString()
            };

            let index = users.findIndex(user => user.id === parseInt(userId));
            if (index !== -1) {
                users[index] = updatedUser;
                localStorage.setItem("users", JSON.stringify(users));
                localStorage.removeItem("editUser");
                localStorage.removeItem("editingUserId");

                alert("User details updated successfully!");
                showCard(1);
                updateTable();
            }
        });

        function showCard(index) {
            $(".card-content").removeClass("active").eq(index).addClass("active");
        }


        ///starting///

        let currentIndex = 0;
        const cards = $(".card-content");
        const nextButtons = $("#nextBtn");

        updateTable()



        function showCard(index) {
            $(".card-content").removeClass("active").eq(index).addClass("active");
        }

        $("#nextBtn").on("click", function (event) {
            event.preventDefault();

            if (currentIndex === 0) {
                let firstName = $("#first-name").val().trim();
                let lastName = $("#last-name").val().trim();
                let firstNameError = $("#first-name-error");
                let lastNameError = $("#last-name-error");
                let dobDay = $("#dob-date").val().trim();
                let dobMonth = $("#dob-month").val();
                let dobYear = $("#dob-year").val().trim();
                let gender = $("#gender").val();
                let dobError = $("#dob-error");
                let genderError = $("#gender-error");
                let userEmail = $("#user-name").val().trim();
                let emailError = $("#user-name-error");
                let pass = $("#password").val().trim();
                let confirm = $("#confirm").val().trim();
                let passError = $("#password-error");
                let confirmError = $("#confirm-error");

                let dob = `${dobDay}-${dobMonth}-${dobYear}`;

                let isValid = true;
                let emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/;
                let passwordPattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
                $(".error").hide();

                if (firstName === "" || !/^[A-Za-z]+$/.test(firstName)) {
                    $("#first-name-error").show();
                    isValid = false;
                }

                if (lastName !== "" && !/^[A-Za-z]+$/.test(lastName)) {
                    $("#last-name-error").show();
                    isValid = false;
                }

                if (isNaN(parseInt(dobDay)) || parseInt(dobDay) < 1 || parseInt(dobDay) > 31 || dobMonth === "" || isNaN(parseInt(dobYear)) || parseInt(dobYear) < 1920 || parseInt(dobYear) > new Date().getFullYear()) {
                    $("#dob-error").show();
                    isValid = false;
                }

                if (gender === "") {
                    $("#gender-error").show();
                    isValid = false;
                }


                if (userEmail === "" || !emailPattern.test(userEmail)) {
                    $("#user-name-error").show();
                    isValid = false;
                }

                if (!passwordPattern.test(pass)) {
                    $("#password-error").show();
                    isValid = false;
                }

                if (pass !== confirm) {
                    $("#confirm-error").show();
                    isValid = false;
                }



                if (!isValid) return;

                let userData = {
                    id: Date.now(),
                    firstName: firstName,
                    lastName: lastName,
                    dob: dob,
                    gender: gender,
                    userEmail: userEmail,
                    password: pass,
                    createDate: new Date().toLocaleDateString()
                };
                let users = JSON.parse(localStorage.getItem("users")) || [];
                users.push(userData);
                localStorage.setItem("users", JSON.stringify(users));
                updateTable();
            }


            if (currentIndex < cards.length - 1) {
                currentIndex++;
                showCard(currentIndex);
            }
        });



    </script>

</body>

</html>